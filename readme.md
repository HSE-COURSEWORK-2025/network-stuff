# HSE Coursework: конфиги для nginx

Этот репозиторий содержит конфигурации Nginx для организации доступа к вашему сервису через интернет с использованием VPS, OpenVPN и проксирования.

## Архитектура

- У вас арендована VPS с белым IP-адресом и доменным именем http://hse-coursework-health.ru/.
- На VPS работает nginx (конфиг: **nginx.conf.remote**), который принимает HTTP-запросы на 80 порт и проксирует их через OpenVPN-туннель на ваш локальный компьютер с серым IP.
- Локальный компьютер и VPS соединены через OpenVPN, что позволяет им видеть друг друга в приватной сети.
- На локальном компьютере работает nginx с конфигами **nginx.conf.local** и **default.conf.local**.
- Локальный nginx проксирует запросы к самому сервису.

## Содержимое

- **nginx.conf.local**  
  Конфигурация Nginx для локальной разработки и отдачи статики.
  - Слушает порт 3000 на localhost.
  - Отдаёт статические файлы из `/usr/share/nginx/html`.
  - Использует `try_files` для поддержки SPA (Single Page Application).

- **default.conf.local**  
  Пример server-блока для проксирования запросов к сервису `results-provider` с поддержкой CORS.
  - Слушает порт 3000.
  - Проксирует `/results-provider/` на контейнер/сервис `results-provider:8080`.
  - Добавляет необходимые CORS-заголовки для поддержки кросс-доменных запросов.

- **nginx.conf.remote**  
  Конфигурация для удалённого сервера (VPS).
  - Слушает порт 80.
  - Проксирует все запросы на внутренний адрес локального компьютера через OpenVPN-туннель (например, `10.8.0.2:9999`).
  - Поддержка WebSocket-проксирования.
  - Пробрасывает оригинальные заголовки клиента.

## Использование

1. Настройте OpenVPN между VPS и локальным компьютером, чтобы они были в одной приватной сети.
2. На VPS установите nginx с конфигом `nginx.conf.remote` и убедитесь, что домен http://hse-coursework-health.ru/ указывает на ваш VPS.
3. На локальном компьютере установите nginx с конфигами `nginx.conf.local` и/или `default.conf.local`.
4. При необходимости скорректируйте пути, адреса и порты под ваши нужды.
